<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>13 - Creating SSH Enabled Containers · BAWJ</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="BAWJ logo"/></a><div class="docs-package-name"><span class="docs-autofit">BAWJ</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Business Applications with Julia</a></li><li><a class="tocitem" href="../blog/">Blog</a></li><li><a class="tocitem" href="../chapter1/">1 - The Application</a></li><li><span class="tocitem">Section 1 - Experimenting with Modules</span><ul><li><a class="tocitem" href="../chapter2/">2 - Setup the Development Environment</a></li><li><a class="tocitem" href="../chapter3/">3 - Create and Test Domain.jl</a></li><li><a class="tocitem" href="../chapter4/">4 - Create and Test API.jl</a></li><li><a class="tocitem" href="../chapter5/">5 - Create and Test Infrastructure.jl</a></li><li><a class="tocitem" href="../chapter6/">6 - The Accounts Package from a User Point of View</a></li><li><a class="tocitem" href="../chapter7/">7 - Documenting your module</a></li></ul></li><li><span class="tocitem">Section 2 -  The Accounts Receivable Module</span><ul><li><a class="tocitem" href="../chapter8/">8 - The Design</a></li><li><a class="tocitem" href="../chapter9/">9 - The Sub-Module Domain</a></li><li><a class="tocitem" href="../chapter10/">10 - The Sub-Module API</a></li><li><a class="tocitem" href="../chapter11/">11 - The Sub-Module Infrastructure</a></li><li><a class="tocitem" href="../chapter12/">12 - The Main-Module AppliAR.jl</a></li></ul></li><li><span class="tocitem">Section 3 - Using containers</span><ul><li class="is-active"><a class="tocitem" href>13 - Creating SSH Enabled Containers</a><ul class="internal"><li><a class="tocitem" href="#Activity-13.1:-Create-local-SSH-keys"><span>Activity 13.1: Create local SSH keys</span></a></li><li><a class="tocitem" href="#Activity-13.2:-Create-the-Container"><span>Activity 13.2: Create the Container</span></a></li><li><a class="tocitem" href="#The-Dockerfile"><span>The Dockerfile</span></a></li><li><a class="tocitem" href="#Activity-13.3:-Install-Julia"><span>Activity 13.3: Install Julia</span></a></li><li><a class="tocitem" href="#Activity-13.4:-Test-the-container."><span>Activity 13.4: Test the container.</span></a></li><li><a class="tocitem" href="#Exercise-13.1:-Create-a-Second-Container"><span>Exercise 13.1: Create a Second Container</span></a></li></ul></li><li><a class="tocitem" href="../chapter14/">14 - Run the Application in Containers</a></li><li><a class="tocitem" href="../chapter15/">15 - Running the Containers</a></li></ul></li><li><span class="tocitem">Section 4 - Miscellaneous</span><ul><li><a class="tocitem" href="../chapter16/">16 - Logging</a></li><li><a class="tocitem" href="../chapter17/">17 - Implementing AppliAR (Accounts Receivable) Package</a></li><li><a class="tocitem" href="../chapter18/">18 - PosgreSQL</a></li></ul></li><li><a class="tocitem" href="../appendix/">Installation Instruction</a></li><li><a class="tocitem" href="../notebook/">IJulia Notebook</a></li><li><a class="tocitem" href="../overview/">Overview Julia</a></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Section 3 - Using containers</a></li><li class="is-active"><a href>13 - Creating SSH Enabled Containers</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>13 - Creating SSH Enabled Containers</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/rbontekoe/BAWJ/blob/master/docs/src/chapter13.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id=".-Creating-SSH-Enabled-Containers"><a class="docs-heading-anchor" href="#.-Creating-SSH-Enabled-Containers">13. Creating SSH Enabled Containers</a><a id=".-Creating-SSH-Enabled-Containers-1"></a><a class="docs-heading-anchor-permalink" href="#.-Creating-SSH-Enabled-Containers" title="Permalink"></a></h1><p>In this chapter, you will learn how to communicate with Julia between different Docker containers. One uses SSH for this. The condition is that you can set up the connection without using a password by using SSH keys.</p><p>The article <a href="https://docs.docker.com/engine/examples/running_ssh_service/">Dockerize an SSH service</a> uses Ubuntu 16.04 as the base image. However, Julia 1.0 and higher needs Ubuntu 18.04, so we have changed the Dockerfile. This version of Ubuntu also requires that you create a user with administrator rights when you use SSH to connect.</p><p>You create a Docker container using a Docker image. You need a Docker installation file to create an image. By default, the file is called <code>Dockerfile</code>.</p><p>Once you have started the container, you make it suitable for a passwordless SSH connection.</p><p>Finally, you install the software needed for the application, including Julia.</p><p>See also the Pact book Julia 1.0 Programming: <a href="https://subscription.packtpub.com/book/application_development/9781788998369/1/ch01lvl1sec12/installing-julia-from-binaries">Installing Julia from binaries</a></p><h5 id="Contents"><a class="docs-heading-anchor" href="#Contents">Contents</a><a id="Contents-1"></a><a class="docs-heading-anchor-permalink" href="#Contents" title="Permalink"></a></h5><ul><li><a href="#.-Creating-SSH-Enabled-Containers">13. Creating SSH Enabled Containers</a></li><ul><li><a href="#Activity-13.1:-Create-local-SSH-keys">Activity 13.1: Create local SSH keys</a></li><li><a href="#Activity-13.2:-Create-the-Container">Activity 13.2: Create the Container</a></li><li><a href="#The-Dockerfile">The Dockerfile</a></li><li><a href="#Activity-13.3:-Install-Julia">Activity 13.3: Install Julia</a></li><li><a href="#Activity-13.4:-Test-the-container.">Activity 13.4: Test the container.</a></li><li><a href="#Exercise-13.1:-Create-a-Second-Container">Exercise 13.1: Create a Second Container</a></li></ul></ul><h2 id="Activity-13.1:-Create-local-SSH-keys"><a class="docs-heading-anchor" href="#Activity-13.1:-Create-local-SSH-keys">Activity 13.1: Create local SSH keys</a><a id="Activity-13.1:-Create-local-SSH-keys-1"></a><a class="docs-heading-anchor-permalink" href="#Activity-13.1:-Create-local-SSH-keys" title="Permalink"></a></h2><p>You need SSH keys for passwordless Julia communication between Docker containers.</p><h5 id="Prerequisites"><a class="docs-heading-anchor" href="#Prerequisites">Prerequisites</a><a id="Prerequisites-1"></a><a class="docs-heading-anchor-permalink" href="#Prerequisites" title="Permalink"></a></h5><ul><li>Your system has Ubuntu 20.04 that runs on an Intel x86 processor.</li><li>You have started your computer.</li><li>You haven&#39;t created the SSH keys before.</li></ul><p>In this activity you will: </p><ol><li><a href="#Step-1:-Check-previous-created-keys">Check previously created keys</a>.</li><li><a href="#Step-2:-Create-local-SSH-keys-on-your-computer">Create local SSH keys</a>.</li></ol><h5 id="Step-1:-Check-previous-created-keys"><a class="docs-heading-anchor" href="#Step-1:-Check-previous-created-keys">Step 1: Check previous created keys</a><a id="Step-1:-Check-previous-created-keys-1"></a><a class="docs-heading-anchor-permalink" href="#Step-1:-Check-previous-created-keys" title="Permalink"></a></h5><p>The folder <code>.shh</code> contains your keys if you have them created before.</p><table><tr><th style="text-align: left">Step</th><th style="text-align: left">Action</th><th style="text-align: left">Comment</th></tr><tr><td style="text-align: left">1</td><td style="text-align: left">$ ls -l ~/.ssh</td><td style="text-align: left"></td></tr></table><p><strong>Response</strong></p><pre><code class="language-none">ls: cannot access &#39;.ssh&#39;: No such file or directory</code></pre><p>You haven&#39;t created the key before, go to step 2.</p><pre><code class="language-none">total 16
-rw------- 1 rob rob 3389 okt  8 16:48 id_rsa
-rw-r--r-- 1 rob rob  748 okt  8 16:48 id_rsa.pub
-rw------- 1 rob rob 1554 nov 17 14:56 known_hosts
-rw------- 1 rob rob 1554 nov 17 14:08 known_hosts.old</code></pre><p>You have created the keys before, no further action is required. The file id_rsa.pub contains your public key. Later on, we will create a copy of it in the SSH enabled container.</p><h5 id="Step-2:-Create-local-SSH-keys-on-your-computer"><a class="docs-heading-anchor" href="#Step-2:-Create-local-SSH-keys-on-your-computer">Step 2: Create local SSH keys on your computer</a><a id="Step-2:-Create-local-SSH-keys-on-your-computer-1"></a><a class="docs-heading-anchor-permalink" href="#Step-2:-Create-local-SSH-keys-on-your-computer" title="Permalink"></a></h5><p>The <code>openssh-client</code> software is needed to create the keys.</p><table><tr><th style="text-align: left">Step</th><th style="text-align: left">Action</th><th style="text-align: left">Comment</th></tr><tr><td style="text-align: left">1</td><td style="text-align: left">$ sudo apt-get update</td><td style="text-align: left"></td></tr><tr><td style="text-align: left">2</td><td style="text-align: left">$ sudo apt-get install openssh-client</td><td style="text-align: left">Install ssh client on Ubuntu.</td></tr><tr><td style="text-align: left">3</td><td style="text-align: left">$ ls -al ~/.ssh/id_*.pub</td><td style="text-align: left">View old keys.</td></tr><tr><td style="text-align: left">4</td><td style="text-align: left">$ ssh-keygen -t rsa -b 4096 -C &quot;your_email@domain.com&quot;</td><td style="text-align: left">Generate the key.</td></tr><tr><td style="text-align: left">5</td><td style="text-align: left">$ ls ~/.ssh/id_*</td><td style="text-align: left">View your new keys.</td></tr></table><p>See <a href="https://likegeeks.com/ssh-connection-refused/#Change-in-public-keys-after-reinstall">SSH Connection Refused (Causes &amp; Solutions)</a></p><table><tr><th style="text-align: left">Step</th><th style="text-align: left">Action</th><th style="text-align: left">Comment</th></tr><tr><td style="text-align: left">6</td><td style="text-align: left">$ chmod 700 ~/.ssh</td><td style="text-align: left">Change right the folder .ssh</td></tr><tr><td style="text-align: left">7</td><td style="text-align: left">$ chmod 600 ~/.ssh/authorized_keys</td><td style="text-align: left">Change right of the file authorized_keys</td></tr></table><h2 id="Activity-13.2:-Create-the-Container"><a class="docs-heading-anchor" href="#Activity-13.2:-Create-the-Container">Activity 13.2: Create the Container</a><a id="Activity-13.2:-Create-the-Container-1"></a><a class="docs-heading-anchor-permalink" href="#Activity-13.2:-Create-the-Container" title="Permalink"></a></h2><p>When you want to create a container you need an image. An image is created from a <code>Dockerfile.</code></p><h5 id="Prerequisites:"><a class="docs-heading-anchor" href="#Prerequisites:">Prerequisites:</a><a id="Prerequisites:-1"></a><a class="docs-heading-anchor-permalink" href="#Prerequisites:" title="Permalink"></a></h5><ul><li>Your system has Ubuntu 20.04 that runs on an Intel x86 processor.</li><li>You have started your computer.</li><li>You have installed <a href="../appendix/index.html#Install-Docker">Docker</a>.</li></ul><p>In this activity you will:</p><ol><li><a href="#Step-1:-Create-a-Dockerfile-in-the-folder-test_ssh">Create a Dockerfile in the folder test_sshd</a>.</li><li><a href="#Step-2:-Create-a-Docker-image-eg_sshd-and-the-container-test_sshd">Create a Docker image eg_ssdh and the container test_sshd</a>.</li><li><a href="#Step-3:-Create-a-user-rob,-who-has-administrator-rights">Create a user <code>rob</code>, who has administrator rights</a>.</li></ol><h2 id="The-Dockerfile"><a class="docs-heading-anchor" href="#The-Dockerfile">The Dockerfile</a><a id="The-Dockerfile-1"></a><a class="docs-heading-anchor-permalink" href="#The-Dockerfile" title="Permalink"></a></h2><pre><code class="language-none">FROM ubuntu:20.04

RUN apt-get update &amp;&amp; apt-get install -y openssh-server
RUN mkdir /var/run/sshd
RUN sed -i &#39;s/PermitRootLogin prohibit-password/PermitRootLogin yes/&#39; /etc/ssh/sshd_config

# SSH login fix. Otherwise, the user is kicked off after login
RUN sed &#39;s@session\s*required\s*pam_loginuid.so@session optional pam_loginuid.so@g&#39; -i /etc/pam.d/sshd

ENV NOTVISIBLE &quot;in users profile&quot;
RUN echo &quot;export VISIBLE=now&quot; &gt;&gt; /etc/profile

EXPOSE 22
CMD [&quot;/usr/sbin/sshd&quot;, &quot;-D&quot;]</code></pre><h5 id="Step-1:-Create-a-Dockerfile-in-the-folder-test_ssh"><a class="docs-heading-anchor" href="#Step-1:-Create-a-Dockerfile-in-the-folder-test_ssh">Step 1: Create a Dockerfile in the folder test_ssh</a><a id="Step-1:-Create-a-Dockerfile-in-the-folder-test_ssh-1"></a><a class="docs-heading-anchor-permalink" href="#Step-1:-Create-a-Dockerfile-in-the-folder-test_ssh" title="Permalink"></a></h5><p>You create the file <code>Dockerfile</code> in the folder e.g. test_ssh.</p><table><tr><th style="text-align: left">Step</th><th style="text-align: left">Action</th><th style="text-align: left">Comment</th></tr><tr><td style="text-align: left">2</td><td style="text-align: left">$ sudo mkdir test-ssh</td><td style="text-align: left">Create a new folder.</td></tr><tr><td style="text-align: left">3</td><td style="text-align: left">$ cd test-ssh</td><td style="text-align: left">Go to the folder.</td></tr><tr><td style="text-align: left">4</td><td style="text-align: left">Select the content of the Dockerfile <a href="#The-Dockerfile-1">above</a></td><td style="text-align: left"></td></tr><tr><td style="text-align: left">5</td><td style="text-align: left">Ctrl-C</td><td style="text-align: left">Copy the selected text to the clipboard.</td></tr><tr><td style="text-align: left">6</td><td style="text-align: left">$ sudo nano Dockerfile</td><td style="text-align: left">Create a new empty file.</td></tr><tr><td style="text-align: left">7</td><td style="text-align: left">Shift-Ctrl-V</td><td style="text-align: left">Paste text from the clipboard into nano.</td></tr><tr><td style="text-align: left">8</td><td style="text-align: left">Ctrl-O &lt;Enter&gt;</td><td style="text-align: left">Save the file.</td></tr><tr><td style="text-align: left">9</td><td style="text-align: left">Ctrl-X</td><td style="text-align: left">Exit nano.</td></tr></table><h5 id="Step-2:-Create-a-Docker-image-eg_sshd-and-the-container-test_sshd"><a class="docs-heading-anchor" href="#Step-2:-Create-a-Docker-image-eg_sshd-and-the-container-test_sshd">Step 2: Create a Docker image eg_sshd and the container test_sshd</a><a id="Step-2:-Create-a-Docker-image-eg_sshd-and-the-container-test_sshd-1"></a><a class="docs-heading-anchor-permalink" href="#Step-2:-Create-a-Docker-image-eg_sshd-and-the-container-test_sshd" title="Permalink"></a></h5><p>You need an image before you can create a Docker container.</p><table><tr><th style="text-align: left">Step</th><th style="text-align: left">Action</th><th style="text-align: left">Comment</th></tr><tr><td style="text-align: left">1</td><td style="text-align: left">$ sudo docker build -t eg_sshd .</td><td style="text-align: left">Create a Docker image from the Dockerfile</td></tr><tr><td style="text-align: left">2</td><td style="text-align: left">$ sudo docker run -d -p 2222:22 --name test_sshd eg_sshd</td><td style="text-align: left">Create a container</td></tr><tr><td style="text-align: left">3</td><td style="text-align: left">$ sudo docker exec -it test_sshd bash</td><td style="text-align: left">Enter the container</td></tr><tr><td style="text-align: left">4</td><td style="text-align: left">Ctrl-D</td><td style="text-align: left">Leave the container.</td></tr></table><div class="admonition is-info"><header class="admonition-header">Run docker commands without sudo</header><div class="admonition-body"><p>Create the <a href="https://docs.docker.com/engine/install/linux-postinstall/">docker group</a> and add your user:</p><ol><li>Create the docker group: $ sudo groupadd docker.</li><li>Add your user to the docker group: $ sudo usermod -aG docker USER.</li><li>Log out and log back in so that your group membership is re-evaluated. ...</li><li>Verify that you can run docker commands without sudo </li></ol></div></div><h5 id="Step-3:-Create-a-user-rob,-who-has-administrator-rights"><a class="docs-heading-anchor" href="#Step-3:-Create-a-user-rob,-who-has-administrator-rights">Step 3: Create a user <code>rob</code>, who has administrator rights</a><a id="Step-3:-Create-a-user-rob,-who-has-administrator-rights-1"></a><a class="docs-heading-anchor-permalink" href="#Step-3:-Create-a-user-rob,-who-has-administrator-rights" title="Permalink"></a></h5><table><tr><th style="text-align: left">Step</th><th style="text-align: left">Action</th><th style="text-align: left">Comment</th></tr><tr><td style="text-align: left">1</td><td style="text-align: left">Implement the instructions of the info box above</td><td style="text-align: left">Run docker commands without sudo.</td></tr><tr><td style="text-align: left">2</td><td style="text-align: left">$ docker exec -it test_sshd bash</td><td style="text-align: left">Enter the container</td></tr><tr><td style="text-align: left">3</td><td style="text-align: left"># adduser rob</td><td style="text-align: left">You get the next response:</td></tr></table><pre><code class="language-none">Adding user `rob&#39; ...
Adding new group `rob&#39; (1000) ...
Adding new user `rob&#39; (1000) with group `rob&#39; ...
The home directory `/home/rob&#39; already exists.  Not copying from `/etc/skel&#39;.
adduser: Warning: The home directory `/home/rob&#39; does not belong to the user you are currently creating.
Enter new UNIX password:
Retype new UNIX password:
passwd: password updated successfully
Changing the user information for rob
Enter the new value, or press ENTER for the default
    Full Name []: Rob Bontekoe
    Room Number []:
    Work Phone []:
    Home Phone []:
    Other []:
Is the information correct? [Y/n] Y</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>You are asked to give the user rob a password. The password you will use in the future for the SSH connection to the container, so write it down. You need it the first time when you want to enable passwordless communication. From Ubuntu 20.04 on, you don&#39;t know the roots&#39; password anymore. That is the reason we had to create a user with administrator rights for SSH connections.</p></div></div><table><tr><th style="text-align: left">Step</th><th style="text-align: left">Action</th><th style="text-align: left">Comment</th></tr><tr><td style="text-align: left">3</td><td style="text-align: left"># usermod -aG sudo rob</td><td style="text-align: left">Give user administrator rights.</td></tr><tr><td style="text-align: left">4</td><td style="text-align: left"># apt-get update</td><td style="text-align: left"></td></tr><tr><td style="text-align: left">4</td><td style="text-align: left"># apt-get install sudo</td><td style="text-align: left">You act as root when you precede your commands with <code>sudo.</code> It is not installed yet in this minimized container.</td></tr><tr><td style="text-align: left">5</td><td style="text-align: left"># su rob</td><td style="text-align: left">Switch from user root to the user rob:</td></tr></table><pre><code class="language-none">To run a command as administrator (user &quot;root&quot;), use &quot;sudo &lt;command&gt;&quot;. \nSee &quot;man sudo_root&quot; for details.</code></pre><table><tr><th style="text-align: left">Step</th><th style="text-align: left">Action</th><th style="text-align: left">Comment</th></tr><tr><td style="text-align: left">6</td><td style="text-align: left">Ctrl-D</td><td style="text-align: left">Back as user root.</td></tr><tr><td style="text-align: left">7</td><td style="text-align: left">Ctrl-D</td><td style="text-align: left">Leave the container.</td></tr></table><h2 id="Activity-13.3:-Install-Julia"><a class="docs-heading-anchor" href="#Activity-13.3:-Install-Julia">Activity 13.3: Install Julia</a><a id="Activity-13.3:-Install-Julia-1"></a><a class="docs-heading-anchor-permalink" href="#Activity-13.3:-Install-Julia" title="Permalink"></a></h2><p>Installing Julia is done in the same way as you did before.</p><h5 id="Prerequisites:-2"><a class="docs-heading-anchor" href="#Prerequisites:-2">Prerequisites:</a><a class="docs-heading-anchor-permalink" href="#Prerequisites:-2" title="Permalink"></a></h5><ul><li>Your system has Ubuntu 20.04 running on the Intel x86 processor.</li><li>The container test_sshd exists.</li><li>The container has the user <code>rob</code>, who has administrators (sudo) rights.</li></ul><p>In this activity you will:</p><ol><li><a href="#Step-1:-Download-the-Julia-binary-and-copy-it-to-the-container">Download the Julia binary and copy it to the container</a>.</li><li><a href="#Step-2:-Install-Julia-and-test-the-installation">Install Julia and test the installation</a>.</li><li><a href="#Step-3:-Create-a-symbolic-link-to-start-Julia-from-anywhere">Create a symbolic link to start Julia from everywhere</a>.</li></ol><h5 id="Step-1:-Download-the-Julia-binary-and-copy-it-to-the-container"><a class="docs-heading-anchor" href="#Step-1:-Download-the-Julia-binary-and-copy-it-to-the-container">Step 1: Download the Julia binary and copy it to the container</a><a id="Step-1:-Download-the-Julia-binary-and-copy-it-to-the-container-1"></a><a class="docs-heading-anchor-permalink" href="#Step-1:-Download-the-Julia-binary-and-copy-it-to-the-container" title="Permalink"></a></h5><p>With the command <code>docker cp</code> you can copy files to a container.</p><table><tr><th style="text-align: left">Step</th><th style="text-align: left">Action</th><th style="text-align: left">Comment</th></tr><tr><td style="text-align: left">1</td><td style="text-align: left"><a href="https://julialang.org/downloads/">Download Julia</a></td><td style="text-align: left">eg. julia-1.5.3-linux-x86_64.tar.gz</td></tr><tr><td style="text-align: left">2</td><td style="text-align: left">$ docker ps -a</td><td style="text-align: left">Check whether container test_ssh exists.</td></tr><tr><td style="text-align: left">2</td><td style="text-align: left">$ docker start test_sshd</td><td style="text-align: left">Start the container.</td></tr><tr><td style="text-align: left">3</td><td style="text-align: left">$ docker cp ~/Downloads/julia-1.5.3-linux-x86_64.tar.gz test_sshd:/home/rob</td><td style="text-align: left">Copy the downloaded file to the container.</td></tr><tr><td style="text-align: left">4</td><td style="text-align: left">$ docker exec -it test_sshd bash</td><td style="text-align: left">Enter the container.</td></tr><tr><td style="text-align: left">5</td><td style="text-align: left">$ su rob</td><td style="text-align: left">Switch to user rob.</td></tr><tr><td style="text-align: left">6</td><td style="text-align: left">$ cd ~</td><td style="text-align: left">Go to home directory of the user.</td></tr><tr><td style="text-align: left">7</td><td style="text-align: left">$ ls -ll</td><td style="text-align: left">You see the following files:</td></tr></table><pre><code class="language-none">total 102796
-rw-rw-r-- 1 rob rob 105260711 Nov 17 10:17 julia-1.5.3-linux-x86_64.tar.gz</code></pre><h5 id="Step-2:-Install-Julia-and-test-the-installation"><a class="docs-heading-anchor" href="#Step-2:-Install-Julia-and-test-the-installation">Step 2: Install Julia and test the installation</a><a id="Step-2:-Install-Julia-and-test-the-installation-1"></a><a class="docs-heading-anchor-permalink" href="#Step-2:-Install-Julia-and-test-the-installation" title="Permalink"></a></h5><p>Unpack the <code>.tar.gz</code> file and test if Julia starts.</p><table><tr><th style="text-align: left">Step</th><th style="text-align: left">Action</th><th style="text-align: left">Comment</th></tr><tr><td style="text-align: left">1</td><td style="text-align: left">$ sudo mkdir julia</td><td style="text-align: left">Create folder julia. OS asks for yur password.</td></tr><tr><td style="text-align: left">2</td><td style="text-align: left">$ sudo mv julia-1.5.3-linux-x86_64.tar.gz julia</td><td style="text-align: left">Move file to folder.</td></tr><tr><td style="text-align: left">3</td><td style="text-align: left">$ cd julia</td><td style="text-align: left">Enter folder</td></tr><tr><td style="text-align: left">4</td><td style="text-align: left">$ sudo tar -zxvf julia-1.5.3-linux-x86_64.tar.gz</td><td style="text-align: left">Extract the file.</td></tr><tr><td style="text-align: left">5</td><td style="text-align: left">$ ls -ll</td><td style="text-align: left">List the content of the folder:</td></tr></table><pre><code class="language-none">total 102804
drwxr-xr-x 8 1337 1337      4096 Nov  9 18:56 julia-1.5.3
-rw-rw-r-- 1 rob  rob  105260711 Nov 17 10:17 julia-1.5.3-linux-x86_64.tar.gz</code></pre><table><tr><th style="text-align: left">Step</th><th style="text-align: left">Action</th><th style="text-align: left">Comment</th></tr><tr><td style="text-align: left">6</td><td style="text-align: left">$ cd julia-1.5.3/bin/</td><td style="text-align: left">We will test Julia.</td></tr><tr><td style="text-align: left">7</td><td style="text-align: left">$ ./julia</td><td style="text-align: left">Start Julia. You get the next response:</td></tr></table><pre><code class="language-_">   _       _ _(_)_     |  Documentation: https://docs.julialang.org
  (_)     | (_) (_)    |
   _ _   _| |_  __ _   |  Type &quot;?&quot; for help, &quot;]?&quot; for Pkg help.
  | | | | | | |/ _` |  |
  | | |_| | | | (_| |  |  Version 1.5.3 (2020-11-09)
 _/ |\__&#39;_|_|_|\__&#39;_|  |  Official https://julialang.org/ release
|__/                   |

julia&gt;</code></pre><h3 id="Step-3:-Create-a-symbolic-link-to-start-Julia-from-anywhere"><a class="docs-heading-anchor" href="#Step-3:-Create-a-symbolic-link-to-start-Julia-from-anywhere">Step 3: Create a symbolic link to start Julia from anywhere</a><a id="Step-3:-Create-a-symbolic-link-to-start-Julia-from-anywhere-1"></a><a class="docs-heading-anchor-permalink" href="#Step-3:-Create-a-symbolic-link-to-start-Julia-from-anywhere" title="Permalink"></a></h3><p>It is easier if you can start Julia from any folder.</p><table><tr><th style="text-align: left">Step</th><th style="text-align: left">Action</th><th style="text-align: left">Comment</th></tr><tr><td style="text-align: left">1</td><td style="text-align: left">Ctrl-D</td><td style="text-align: left">Leave Julia.</td></tr><tr><td style="text-align: left">2</td><td style="text-align: left">cd ~</td><td style="text-align: left">To home directory.</td></tr><tr><td style="text-align: left">3</td><td style="text-align: left">$ sudo ln -s /home/rob/julia/julia-1.5.3/bin/julia /usr/local/bin/julia</td><td style="text-align: left">Create link.</td></tr><tr><td style="text-align: left">4</td><td style="text-align: left">$ julia</td><td style="text-align: left">Start Julia.</td></tr><tr><td style="text-align: left">5</td><td style="text-align: left">Ctrl-D</td><td style="text-align: left">Leave Julia.</td></tr><tr><td style="text-align: left">6</td><td style="text-align: left">Ctrl-D</td><td style="text-align: left">Leave container.</td></tr></table><h2 id="Activity-13.4:-Test-the-container."><a class="docs-heading-anchor" href="#Activity-13.4:-Test-the-container.">Activity 13.4: Test the container.</a><a id="Activity-13.4:-Test-the-container.-1"></a><a class="docs-heading-anchor-permalink" href="#Activity-13.4:-Test-the-container." title="Permalink"></a></h2><h5 id="Prerequisites:-3"><a class="docs-heading-anchor" href="#Prerequisites:-3">Prerequisites:</a><a class="docs-heading-anchor-permalink" href="#Prerequisites:-3" title="Permalink"></a></h5><ul><li>You have an SSH enabled container.</li><li>You have created the SSH authorized_keys <a href="#Activity-1-Create-local-SSH-keys-1">See</a>.</li></ul><p>In this activity you will:</p><ol><li><a href="#Step-1:-Copy-your-public-key-to-the-container">Copy your public key to the container</a>.</li><li><a href="#Step-2:-Test-the-SSH-connection-with-the-container">Test the SSH connection with the container</a>.</li></ol><h5 id="Step-1:-Copy-your-public-key-to-the-container"><a class="docs-heading-anchor" href="#Step-1:-Copy-your-public-key-to-the-container">Step 1: Copy your public key to the container</a><a id="Step-1:-Copy-your-public-key-to-the-container-1"></a><a class="docs-heading-anchor-permalink" href="#Step-1:-Copy-your-public-key-to-the-container" title="Permalink"></a></h5><p>You copy the public key you created in <a href="#Activity-13.1:-Create-local-SSH-keys">activity 13.1</a> to the container for passwordless authentication.</p><table><tr><th style="text-align: left">Step</th><th style="text-align: left">Action</th><th style="text-align: left">Comment</th></tr><tr><td style="text-align: left">1</td><td style="text-align: left">$ docker ps</td><td style="text-align: left">Check whether the container is already running.</td></tr><tr><td style="text-align: left">2</td><td style="text-align: left">$ docker start test_sshd</td><td style="text-align: left">Start the container if not running.</td></tr><tr><td style="text-align: left">3</td><td style="text-align: left">$ docker inspect test_sshd | grep &quot;IPAddress&quot;</td><td style="text-align: left">Find internal IP address of the container:<span>$\\$</span>172.17.0.2</td></tr><tr><td style="text-align: left">4</td><td style="text-align: left">$ ssh-copy-id rob@172.17.0.2</td><td style="text-align: left">Copy id to container for passwordless login. If you get an error message follow the instructions to remove keys <span>$\\$</span>ssh-keygen -f &quot;/home/rob/.ssh/known_hosts&quot; -R &quot;172.17.0.2&quot;</td></tr></table><p>You get the next message:</p><pre><code class="language-none">The authenticity of host &#39;172.17.0.2 (172.17.0.2)&#39; can&#39;t be established.
ECDSA key fingerprint is SHA256:0qEmNoH8hb1OC73Hcecf4iY44vKAnLYOc6jNsdkkM2U.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</code></pre><p>Type <code>yes</code> and enter your password.</p><h5 id="Step-2:-Test-the-SSH-connection-with-the-container."><a class="docs-heading-anchor" href="#Step-2:-Test-the-SSH-connection-with-the-container.">Step 2: Test the SSH connection with the container.</a><a id="Step-2:-Test-the-SSH-connection-with-the-container.-1"></a><a class="docs-heading-anchor-permalink" href="#Step-2:-Test-the-SSH-connection-with-the-container." title="Permalink"></a></h5><p>Test if it works fine.</p><table><tr><th style="text-align: left">Step</th><th style="text-align: left">Action</th><th style="text-align: left">Comment</th></tr><tr><td style="text-align: left">1</td><td style="text-align: left">$ ssh rob@172.17.0.2</td><td style="text-align: left">You get the next response:</td></tr></table><pre><code class="language-none">Welcome to Ubuntu 20.04.1 LTS (GNU/Linux 5.4.0-53-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

This system has been minimized by removing packages and content that are
not required on a system that users do not log into.

To restore this content, you can run the &#39;unminimize&#39; command.</code></pre><h2 id="Exercise-13.1:-Create-a-Second-Container"><a class="docs-heading-anchor" href="#Exercise-13.1:-Create-a-Second-Container">Exercise 13.1: Create a Second Container</a><a id="Exercise-13.1:-Create-a-Second-Container-1"></a><a class="docs-heading-anchor-permalink" href="#Exercise-13.1:-Create-a-Second-Container" title="Permalink"></a></h2><p>You will create a second Docker container that we will use for the AppliAR module.</p><p>Create a second container <strong>test_sshd2</strong>:</p><ul><li>You don&#39;t have to create the keys again!</li><li>Use the same image eg_sshd.</li><li>Start at <code>Activity 13.2: Create the Container - step 2-2</code>. Use an different port number for ssh (2223): docker run -d -p 2223:22 –name test_sshd2 eg_sshd</li><li>The name of the administrative user can be kept the same: rob.</li></ul><p>We will use both containers in chapter 14.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../chapter12/">« 12 - The Main-Module AppliAR.jl</a><a class="docs-footer-nextpage" href="../chapter14/">14 - Run the Application in Containers »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Wednesday 16 December 2020 16:27">Wednesday 16 December 2020</span>. Using Julia version 1.5.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
