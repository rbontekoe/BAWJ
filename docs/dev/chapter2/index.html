<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>2 - The design · BAWJ</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="BAWJ logo"/></a><div class="docs-package-name"><span class="docs-autofit">BAWJ</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Business Applications with Julia</a></li><li><a class="tocitem" href="../blog/">Blog</a></li><li><span class="tocitem">Section 1 - Building the application</span><ul><li><a class="tocitem" href="../chapter1/">1 - The Application</a></li><li class="is-active"><a class="tocitem" href>2 - The design</a><ul class="internal"><li><a class="tocitem" href="#Terms-and-definitions"><span>Terms and definitions</span></a></li><li><a class="tocitem" href="#A-procedure-as-a-starting-point"><span>A procedure as a starting point</span></a></li><li><a class="tocitem" href="#The-procedure-as-an-activity-diagram"><span>The procedure as an activity diagram</span></a></li><li><a class="tocitem" href="#The-design-2"><span>The design</span></a></li><li><a class="tocitem" href="#ToDo"><span>ToDo</span></a></li></ul></li><li><a class="tocitem" href="../chapter3/">3 - Implementing the design</a></li></ul></li><li><a class="tocitem" href="../notebook/">IJulia Notebook</a></li><li><a class="tocitem" href="../overview/">Overview Julia</a></li><li><a class="tocitem" href="../appendix/">Appendix</a></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Section 1 - Building the application</a></li><li class="is-active"><a href>2 - The design</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>2 - The design</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/rbontekoe/BAWJ/blob/master/docs/src/chapter2.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="The-design"><a class="docs-heading-anchor" href="#The-design">2 - The design</a><a id="The-design-1"></a><a class="docs-heading-anchor-permalink" href="#The-design" title="Permalink"></a></h1><h3 id="What-you-will-learn"><a class="docs-heading-anchor" href="#What-you-will-learn">What you will learn</a><a id="What-you-will-learn-1"></a><a class="docs-heading-anchor-permalink" href="#What-you-will-learn" title="Permalink"></a></h3><ul><li><a href="#The-design">2 - The design</a></li><ul><li><a href="#Terms-and-definitions">Terms and definitions</a></li><li><a href="#A-procedure-as-a-starting-point">A procedure as a starting point</a></li><li><a href="#The-procedure-as-an-activity-diagram">The procedure as an activity diagram</a></li><li><a href="#The-design-2">The design</a></li><li><a href="#ToDo">ToDo</a></li></ul></ul><p>First, let&#39;s look at some terms and definitions. We&#39;ll convert the procedure <code>Invoicing</code> into an activity diagram. Using the Onion Architecture pattern, we define the <code>Domain</code> objects and the Julia <code>API</code>-functions. In the <code>Infrastructure</code> layer, we put the functions that interact with the outer world and the inner layers.</p><hr/><h2 id="Terms-and-definitions"><a class="docs-heading-anchor" href="#Terms-and-definitions">Terms and definitions</a><a id="Terms-and-definitions-1"></a><a class="docs-heading-anchor-permalink" href="#Terms-and-definitions" title="Permalink"></a></h2><p>The points of attention are:</p><ul><li>Procedure,</li><li>Domain-driven design,</li><li>Distributed processing, and</li><li>Style conventions.</li></ul><h3 id="Procedure"><a class="docs-heading-anchor" href="#Procedure">Procedure</a><a id="Procedure-1"></a><a class="docs-heading-anchor-permalink" href="#Procedure" title="Permalink"></a></h3><p>A procedure is a description of work practice, a workflow. It describes a series of activities or actions in a particular order and interacts with people and machines. Actions make use of resources. Data, a service or a product, is the output of work.</p><h3 id="Domain-driven-design"><a class="docs-heading-anchor" href="#Domain-driven-design">Domain-driven design</a><a id="Domain-driven-design-1"></a><a class="docs-heading-anchor-permalink" href="#Domain-driven-design" title="Permalink"></a></h3><p>Each process should be domain-specific. Subject matter experts and users of the domain speak the same language and use the same definitions and synonyms for concepts and objects. It leads to a Domain-driven design paradigm.</p><p>The Onion Architecture lends itself perfectly to the domain-driven design pattern. It divides an application into four areas: core, domain, API, and infrastructure.</p><p>The core consists out of the Julia language constructs and Julia modules. <a href="https://docs.julialang.org/en/v1/manual/modules/index.html">Modules</a> are also called packages.</p><p>The next layer, the domain, defines the domain entities and concepts. Between its elements, there must be coherence. You only use constructs from the <code>core.</code> <code>UnpaidInvoice</code> is an example.</p><p>The next peel is the API. The API consists of Julia functions that operate on the domain elements, and are used to create programs. You only use constructs from the <code>core and the domain.</code></p><p><code>create_unpaidinvoice,</code> <code>create_paidinvoice,</code> <code>create_pdf</code> are examples.</p><p>The infrastructure layer is the ultimate peel. With its functions, it communicates with the external world. Adapters overcome mismatches between interfaces. When you write you the code, you use <code>elements from the inner layers.</code></p><h3 id="Distributed-processing"><a class="docs-heading-anchor" href="#Distributed-processing">Distributed processing</a><a id="Distributed-processing-1"></a><a class="docs-heading-anchor-permalink" href="#Distributed-processing" title="Permalink"></a></h3><p>Programs, written in Julia language, also can run on other processor cores. Even in Docker containers on remote machines. Julia uses the master-worker concept. It means that the master executes Julia&#39;s functions on workers.</p><h3 id="Style-conventions"><a class="docs-heading-anchor" href="#Style-conventions">Style conventions</a><a id="Style-conventions-1"></a><a class="docs-heading-anchor-permalink" href="#Style-conventions" title="Permalink"></a></h3><p>The article <a href="https://github.com/invenia/BlueStyle">Blue: a Style Guide for Julia</a> describes the style conventions.</p><hr/><h2 id="A-procedure-as-a-starting-point"><a class="docs-heading-anchor" href="#A-procedure-as-a-starting-point">A procedure as a starting point</a><a id="A-procedure-as-a-starting-point-1"></a><a class="docs-heading-anchor-permalink" href="#A-procedure-as-a-starting-point" title="Permalink"></a></h2><p>In 1994 we were delivering Lotus Notes instructor-led training in the Netherlands. We became ISO-9001 certified one year later. ISO is short for the International Organization for Standardization. A part of ISO is the section procedures.</p><p>A procedure describes a workflow or business process. It specifies the activities to be carried out by people or machines and the resources that are required to produce a result.</p><p>An input triggers a process. Every action creates an output, most of the time, modified information or side-effects such as saving data.</p><p>The example I use in the course is the procedure <code>Invoicing.</code></p><h3 id="The-course-example"><a class="docs-heading-anchor" href="#The-course-example">The course example</a><a id="The-course-example-1"></a><a class="docs-heading-anchor-permalink" href="#The-course-example" title="Permalink"></a></h3><p>In 1998 we rewrote our procedures as a table. Every row represents an activity or action. Next to the events are the columns with the roles involved with the work. The original procedure:</p><p><strong>Procedure</strong>: Invoicing.</p><p><strong>Roles</strong>: OM = Office Manage, AOM = Assistant Office Manager.</p><p><strong>Input</strong>: List of orders.</p><table><tr><th style="text-align: left">Step</th><th style="text-align: left">Action</th><th style="text-align: left">AOM</th><th style="text-align: left">OM</th><th style="text-align: left">Output</th><th style="text-align: left">Tool</th><th style="text-align: left">Exception</th></tr><tr><td style="text-align: left">1</td><td style="text-align: left">Create an invoice per order</td><td style="text-align: left">R</td><td style="text-align: left">A</td><td style="text-align: left">Created and authorized invoices</td><td style="text-align: left">Order file</td><td style="text-align: left"></td></tr><tr><td style="text-align: left">2</td><td style="text-align: left">Archive a copy of the invoice</td><td style="text-align: left">R</td><td style="text-align: left"></td><td style="text-align: left">Archived copy</td><td style="text-align: left">Accounts Receivable unpaid</td><td style="text-align: left"></td></tr><tr><td style="text-align: left">3</td><td style="text-align: left">Send the invoice to the customer</td><td style="text-align: left">R</td><td style="text-align: left">I</td><td style="text-align: left">Invoice sent</td><td style="text-align: left"></td><td style="text-align: left"></td></tr><tr><td style="text-align: left">4</td><td style="text-align: left">Book the invoice</td><td style="text-align: left">R</td><td style="text-align: left">A</td><td style="text-align: left">Booked invoice</td><td style="text-align: left">General ledger</td><td style="text-align: left"></td></tr><tr><td style="text-align: left">5</td><td style="text-align: left">Book the paid invoice</td><td style="text-align: left">R</td><td style="text-align: left">A</td><td style="text-align: left">Paid invoice</td><td style="text-align: left">Bank records, General ledger</td><td style="text-align: left"></td></tr><tr><td style="text-align: left">6</td><td style="text-align: left">Archive the paid invoice</td><td style="text-align: left">R</td><td style="text-align: left">I</td><td style="text-align: left">Archived invoice</td><td style="text-align: left">Accounts Receivable paid</td><td style="text-align: left"></td></tr><tr><td style="text-align: left">7</td><td style="text-align: left">Check unpaid invoices</td><td style="text-align: left"></td><td style="text-align: left">R</td><td style="text-align: left">List of unpaid invoices to contact customer</td><td style="text-align: left">Note in CRM system</td><td style="text-align: left"></td></tr></table><p><strong>RASCI</strong></p><ul><li>R = Responsible, the entity who is responsible for the execution of the activity.</li><li>A = Approves, the entity who approves the result before going to the next step.</li><li>S = Supports, the members of the team.</li><li>C = Consults, an entity.</li><li>I = Informed, notify the entity about the result.</li></ul><p>Let&#39;s see how we can automate the procedure with Julia. We tackle it with a technique of Domain-Driven Design and the Onion architecture.</p><hr/><h2 id="The-procedure-as-an-activity-diagram"><a class="docs-heading-anchor" href="#The-procedure-as-an-activity-diagram">The procedure as an activity diagram</a><a id="The-procedure-as-an-activity-diagram-1"></a><a class="docs-heading-anchor-permalink" href="#The-procedure-as-an-activity-diagram" title="Permalink"></a></h2><p>The activity diagram represents the workflow. The actions are Julia functions. You can add typed arguments and return values in Julia, noted by a double colon (::) followed by the name of the type. This defines the domain entities, e.g., <code>::Order, ::UnpaidInvoice</code>.</p><pre><code class="language-none">⚉ process(::Array{Order)
    ↓
    create(::Array{Order}::Array{UnpaidInvoice}
    ↓
    send_email(::Array{UnpaidInvoice}) # TODO
    ↓
    archive(::Array{UnpaidInvoice})
    ↓
    create(::Array{UnpaidInvoice}::Array{JournalEntry}
    ↓
    return ::Array{JournalEntry}
    ↓
    ◉

⚉ process(::Array{UnpaidInvoice}, ::Array{BankStatement})
    ↓
    filter(::Array{UnpaidInvoice}, ::Array{Bankstatement})::Array{PaidInvoice}
    ↓
    archive(::Array{PaidInvoice})
    ↓
    create(::Array{PaidInvoice})::Array{JournalEntry}
    ↓
    return ::Array{JournalEntry}
    ↓
    ◉

⚉ report(::Array{UnpaidInvoice}, days::Int) # TODO
    ↓
    filter(::Array{UnpaidInvoice, ::Int}::Array{UnpaidInvoiceDue}
    ↓
    return ::Array{UnpaidInvoiceDue}
    ↓
    ◉</code></pre><h2 id="The-design-2"><a class="docs-heading-anchor" href="#The-design-2">The design</a><a class="docs-heading-anchor-permalink" href="#The-design-2" title="Permalink"></a></h2><p>From the activity diagram we get:</p><h3 id="Domain-Elements"><a class="docs-heading-anchor" href="#Domain-Elements">Domain Elements</a><a id="Domain-Elements-1"></a><a class="docs-heading-anchor-permalink" href="#Domain-Elements" title="Permalink"></a></h3><p>The domain objects (types) are:</p><p>Domain Types:</p><ul><li>UnpaidInvoice;</li><li>PaidInvoice;</li><li>BankStatement.</li></ul><p>External Types:</p><ul><li>AppliSales.Order¹;</li><li>AppliGeneralLedger.JournalEntry².</li></ul><p>General packages:</p><ul><li>Dates³;</li><li>DataFrames³</li></ul><p>¹ Defined in the package AppliSales.</p><p>² Defined in the package <a href="https://www.appligate.nl/AppliGeneralLedger.jl/">AppliGeneralLedger</a>.</p><p>³ Dates is a sub-module of Julia. A package for manipulating data is <a href="https://en.wikibooks.org/wiki/Introducing_Julia/DataFrames">DataFrames</a>. The DataFrame data structure is comparable to a spreadsheet.</p><h3 id="API"><a class="docs-heading-anchor" href="#API">API</a><a id="API-1"></a><a class="docs-heading-anchor-permalink" href="#API" title="Permalink"></a></h3><p>The API contains the methods (functions) of the module. The methods use only elements from the core or domain. An overview of we need:</p><ul><li>create(::Array{Order,1})::Array{UnpaidInvoice, 1}</li><li>create(::Array{UnpaidInvoice, 1}, ::Array{BankStatement, 1})::Array{PaidInvoice,1)</li><li>conv2entry(inv::Array{UnpaidInvoice, 1}, from::Int, to::Int)::Array{JournalEntry, 1}</li><li>conv2entry(inv::Array{PaidInvoice, 1}, from::Int, to::Int)::Array{JournalEntry, 1}</li></ul><p>In Julia, you can use the same function name as long as the <code>signature</code> is different, so other types and, or the number of arguments. One calls it <a href="https://en.wikipedia.org/wiki/Multiple_dispatch"><code>multiple dispatch</code></a>.</p><p>An <code>Order</code>, consists of the data objects <code>Training, and Company</code> plus additional data about <code>contact</code>, and <code>student</code>. It is defined in <code>domain.jl</code> the support-package <a href="https://github.com/rbontekoe/AppliSales.jl/blob/master/src/domain/domain.jl">AppliSales</a>.</p><p>Also, we have already created a support-package <a href="https://github.com/rbontekoe/AppliGeneralLedger.jl">AppliGeneralLedger</a> to make it easier to test AppliAR.jl. JournalEntry is defined in <a href="https://github.com/rbontekoe/AppliGeneralLedger.jl/blob/master/src/domain/domain.jl">domain.jl</a>.</p><h3 id="Methods-of-the-Infrastructure-layer"><a class="docs-heading-anchor" href="#Methods-of-the-Infrastructure-layer">Methods of the Infrastructure layer</a><a id="Methods-of-the-Infrastructure-layer-1"></a><a class="docs-heading-anchor-permalink" href="#Methods-of-the-Infrastructure-layer" title="Permalink"></a></h3><p>Database, private methods:</p><ul><li>add_to_file(file::String, data::Array{Any, 1}</li><li>read_from_file(file::String)::Array{Any, 1}</li></ul><p>External accessable methods:</p><ul><li>read_bank_statements(path::String)::Array{BankStatement,1}</li><li>process(::Array{Order)::Array{JounalEntry, 1}</li><li>process(::UnpaidInvoice, ::BankStatement)::Array{JounalEntry, 1}</li><li>retrieve_unpaid_invoices()::Array{UnpaidInvoice, 1}</li><li>retrieve_paid_invoice()::Array{PaidInvoice, 1}</li></ul><h2 id="ToDo"><a class="docs-heading-anchor" href="#ToDo">ToDo</a><a id="ToDo-1"></a><a class="docs-heading-anchor-permalink" href="#ToDo" title="Permalink"></a></h2><ul><li>I am thinking of Literate.jl as a package to make PDFs.</li><li>How to attach a PDF to an email?</li><li>How to send an email?</li><li><a href="https://github.com/aviks/SMTPClient.jl">SMTPClient.jl</a></li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../chapter1/">« 1 - The Application</a><a class="docs-footer-nextpage" href="../chapter3/">3 - Implementing the design »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Wednesday 22 July 2020 17:17">Wednesday 22 July 2020</span>. Using Julia version 1.3.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
