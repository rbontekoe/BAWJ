<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>15 - Running the Containers · BAWJ</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="BAWJ logo"/></a><div class="docs-package-name"><span class="docs-autofit">BAWJ</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Business Applications with Julia</a></li><li><a class="tocitem" href="../blog/">Blog</a></li><li><a class="tocitem" href="../chapter1/">1 - The Application</a></li><li><span class="tocitem">Section 1 - Experimenting with Modules</span><ul><li><a class="tocitem" href="../chapter2/">2 - Setup the Development Environment</a></li><li><a class="tocitem" href="../chapter3/">3 - Create and Test Domain.jl</a></li><li><a class="tocitem" href="../chapter4/">4 - Create and Test API.jl</a></li><li><a class="tocitem" href="../chapter5/">5 - Create and Test Infrastructure.jl</a></li><li><a class="tocitem" href="../chapter6/">6 - The Accounts Package from a User Point of View</a></li><li><a class="tocitem" href="../chapter7/">7 - Documenting your module</a></li></ul></li><li><span class="tocitem">Section 2 -  The Accounts Receivable Module</span><ul><li><a class="tocitem" href="../chapter8/">8 - The Design</a></li><li><a class="tocitem" href="../chapter9/">9 - The Sub-Module Domain</a></li><li><a class="tocitem" href="../chapter10/">10 - The Sub-Module API</a></li><li><a class="tocitem" href="../chapter11/">11 - The Sub-Module Infrastructure</a></li><li><a class="tocitem" href="../chapter12/">12 - The Main-Module AppliAR.jl</a></li></ul></li><li><span class="tocitem">Section 3 - Using containers</span><ul><li><a class="tocitem" href="../chapter13/">13 - Creating SSH Enabled Containers</a></li><li><a class="tocitem" href="../chapter14/">14 - Run the Application in Containers</a></li><li class="is-active"><a class="tocitem" href>15 - Running the Containers</a><ul class="internal"><li><a class="tocitem" href="#Activity-1:-Cloning-the-code-1"><span>Activity 1: Cloning the code</span></a></li><li><a class="tocitem" href="#Activity-2:-Create-the-application-1"><span>Activity 2: Create the application</span></a></li><li><a class="tocitem" href="#Example-test-code-1"><span>Example test code</span></a></li></ul></li></ul></li><li><span class="tocitem">Section 4 - Miscelanious</span><ul><li><a class="tocitem" href="../chapter16/">16 - Logging</a></li><li><a class="tocitem" href="../chapter17/">17 - Implementing AppliAR (Accounts Receivable) Package</a></li><li><a class="tocitem" href="../chapter18/">18 - PosgreSQL</a></li></ul></li><li><a class="tocitem" href="../appendix/">Installation Instruction</a></li><li><a class="tocitem" href="../notebook/">IJulia Notebook</a></li><li><a class="tocitem" href="../overview/">Overview Julia</a></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Section 3 - Using containers</a></li><li class="is-active"><a href>15 - Running the Containers</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>15 - Running the Containers</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/rbontekoe/BAWJ/blob/master/docs/src/chapter15.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id=".-Running-the-Containers-1"><a class="docs-heading-anchor" href="#.-Running-the-Containers-1">15. Running the Containers</a><a class="docs-heading-anchor-permalink" href="#.-Running-the-Containers-1" title="Permalink"></a></h1><p>UNDER DEVELOPMENT!</p><h3 id="Contents-1"><a class="docs-heading-anchor" href="#Contents-1">Contents</a><a class="docs-heading-anchor-permalink" href="#Contents-1" title="Permalink"></a></h3><ul><li><a href="#.-Running-the-Containers-1">15. Running the Containers</a></li><ul><li><a href="#Activity-1:-Cloning-the-code-1">Activity 1: Cloning the code</a></li><li><a href="#Activity-2:-Create-the-application-1">Activity 2: Create the application</a></li><li><a href="#Example-test-code-1">Example test code</a></li></ul></ul><p>In chapter 13, we combine what we have learned in chapter 6, <code>Testing the application</code> and chapter 12 <code>Creating SSH enabled Containers.</code> We use the the packages <code>AppliSales, AppliInvoicing, and AppliGeneralLedger</code>. In the container <code>test_sshd</code> we use <code>AppliSales, and AppliInvoicing,</code> and in <code>test_sshd2</code> we use <code>AppliGeneralLedger.</code> We will discover that the general ledger data will be stored in a file on <code>test_sshd2.</code></p><h5 id="Activity-1:-1"><a class="docs-heading-anchor" href="#Activity-1:-1">Activity 1:</a><a class="docs-heading-anchor-permalink" href="#Activity-1:-1" title="Permalink"></a></h5><p>We start with cloning the code from <code>AppliMaster</code> on GitHub.</p><h5 id="Activity-2:-1"><a class="docs-heading-anchor" href="#Activity-2:-1">Activity 2:</a><a class="docs-heading-anchor-permalink" href="#Activity-2:-1" title="Permalink"></a></h5><p>Create the application.</p><h2 id="Activity-1:-Cloning-the-code-1"><a class="docs-heading-anchor" href="#Activity-1:-Cloning-the-code-1">Activity 1: Cloning the code</a><a class="docs-heading-anchor-permalink" href="#Activity-1:-Cloning-the-code-1" title="Permalink"></a></h2><p>Prerequisites:</p><ul><li>Docker is installed on your computer.</li><li>You have the two containers <code>test_sshd</code> and <code>test_sshd2</code> created in chapter 9, <a href="../chapter10/index.html#Activity-2-Create-the-Container-1">Create the Container</a>.</li><li>Both containers are SSH enabled.</li><li>You have a Internet connection to download the all the modules we need.</li></ul><p>Steps:</p><ol><li>Start both containers and check their Docker internal IP-address.</li><li>Use SSH to connect from test<em>sshd to test</em>sshd2 and install our modules in both containers.</li><li>Create the program.</li></ol><h6 id="Step-1.1-Start-both-containers-1"><a class="docs-heading-anchor" href="#Step-1.1-Start-both-containers-1">Step 1.1 - Start both containers</a><a class="docs-heading-anchor-permalink" href="#Step-1.1-Start-both-containers-1" title="Permalink"></a></h6><table><tr><th style="text-align: left">Step</th><th style="text-align: left">Action</th><th style="text-align: left">Comment</th></tr><tr><td style="text-align: left">1</td><td style="text-align: left">$ docker start test_sshd</td><td style="text-align: left"></td></tr><tr><td style="text-align: left">2</td><td style="text-align: left">$ docker start test_sshd2</td><td style="text-align: left"></td></tr><tr><td style="text-align: left">3</td><td style="text-align: left">$ docker inspect -f &quot;{{ .NetworkSettings.IPAddress }}&quot; test_sshd</td><td style="text-align: left">e.g. 172.17.0.2</td></tr><tr><td style="text-align: left">4</td><td style="text-align: left">$ docker inspect -f &quot;{{ .NetworkSettings.IPAddress }}&quot; test_sshd2</td><td style="text-align: left">e.g. 172.17.0.3</td></tr></table><h6 id="Step-1.2-Use-SSH-to-connect-from-test_sshd-to-test_sshd2-and-install-the-out-modules-1"><a class="docs-heading-anchor" href="#Step-1.2-Use-SSH-to-connect-from-test_sshd-to-test_sshd2-and-install-the-out-modules-1">Step 1.2 - Use SSH to connect from test_sshd to test_sshd2 and install the out modules</a><a class="docs-heading-anchor-permalink" href="#Step-1.2-Use-SSH-to-connect-from-test_sshd-to-test_sshd2-and-install-the-out-modules-1" title="Permalink"></a></h6><table><tr><th style="text-align: left">Step</th><th style="text-align: left">Action</th><th style="text-align: left">Comment</th></tr><tr><td style="text-align: left">1</td><td style="text-align: left">$ ssh rob@172.17.0.2</td><td style="text-align: left">Enter the container test_sshd.</td></tr><tr><td style="text-align: left">2</td><td style="text-align: left">$ julia</td><td style="text-align: left">Start Julia.</td></tr><tr><td style="text-align: left">3</td><td style="text-align: left">julia&gt; ]</td><td style="text-align: left">Go to the package manager.</td></tr><tr><td style="text-align: left">4</td><td style="text-align: left">pkg&gt; add https://github.com/rbontekoe/AppliSales.jl</td><td style="text-align: left">Install AppliSales.jl.</td></tr><tr><td style="text-align: left">5</td><td style="text-align: left">pkg&gt; add https://github.com/rbontekoe/AppliInvoicing.jl</td><td style="text-align: left">Install AppliInvoicing.jl.</td></tr><tr><td style="text-align: left">6</td><td style="text-align: left">pkg&gt; add https://github.com/rbontekoe/AppliGeneralLedger.jl</td><td style="text-align: left">Install AppliGeneralLedger.jl.</td></tr><tr><td style="text-align: left">7</td><td style="text-align: left">Ctrl-C</td><td style="text-align: left">Return to REPL prompt.</td></tr><tr><td style="text-align: left">8</td><td style="text-align: left">Ctrl-D</td><td style="text-align: left">Leave Julia.</td></tr><tr><td style="text-align: left">9</td><td style="text-align: left">$ ssh rob@172.17.0.3</td><td style="text-align: left">Enter the container test_sshd2.</td></tr><tr><td style="text-align: left">10</td><td style="text-align: left">Repeat step 5, 6, and 7</td><td style="text-align: left">All our packages are available in test_sshd2.</td></tr><tr><td style="text-align: left">11</td><td style="text-align: left">Leave the container test_sshd2.</td><td style="text-align: left"></td></tr></table><h6 id="Step-1.3-Clone-AppliMaster-1"><a class="docs-heading-anchor" href="#Step-1.3-Clone-AppliMaster-1">Step 1.3 - Clone AppliMaster</a><a class="docs-heading-anchor-permalink" href="#Step-1.3-Clone-AppliMaster-1" title="Permalink"></a></h6><table><tr><th style="text-align: left">Step</th><th style="text-align: left">Action</th><th style="text-align: left">Comment</th></tr><tr><td style="text-align: left">1</td><td style="text-align: left">$ git clone https://github.com/rbontekoe/Master.jl.git</td><td style="text-align: left">A folder AppliMaster.jl will be created.</td></tr><tr><td style="text-align: left">2</td><td style="text-align: left">$ ls</td><td style="text-align: left"></td></tr><tr><td style="text-align: left">3</td><td style="text-align: left">Ctrl-D</td><td style="text-align: left">Leave the container.</td></tr></table><h2 id="Activity-2:-Create-the-application-1"><a class="docs-heading-anchor" href="#Activity-2:-Create-the-application-1">Activity 2: Create the application</a><a class="docs-heading-anchor-permalink" href="#Activity-2:-Create-the-application-1" title="Permalink"></a></h2><p>Prerequisites:</p><ul><li>Docker is installed on your computer.</li><li>You have the two containers test<em>sshd and test</em>sshd2 created in <code>Chapter 9, Create the Container</code>.</li><li>Both containers are SSH-enabled.</li><li>Julia is installed in the directory <code>julia</code> on the containers.</li><li>The AppliSales, AppliInvoicing, and AppliGeneralLedger packages are installed in both containers.</li></ul><p>Steps</p><ol><li>Start the container <code>test_sshd</code> and create main.jl with nano.</li><li>Run the application.</li></ol><h6 id=".-Start-the-container-test_sshd-and-test_sshd2-1"><a class="docs-heading-anchor" href="#.-Start-the-container-test_sshd-and-test_sshd2-1">1. Start the container test_sshd and test_sshd2</a><a class="docs-heading-anchor-permalink" href="#.-Start-the-container-test_sshd-and-test_sshd2-1" title="Permalink"></a></h6><table><tr><th style="text-align: left">Step</th><th style="text-align: left">Action</th><th style="text-align: left">Comment</th></tr><tr><td style="text-align: left">1</td><td style="text-align: left">$ docker start test_sshd</td><td style="text-align: left">Start the first container.</td></tr><tr><td style="text-align: left">2</td><td style="text-align: left">$ docker inspect -f &quot;{{ .NetworkSettings.IPAddress }}&quot; test_sshd</td><td style="text-align: left">Displays docker address, eg, 172.17.0.2.</td></tr><tr><td style="text-align: left">3</td><td style="text-align: left">Take a note of the ip-address of test_sshd</td><td style="text-align: left"></td></tr><tr><td style="text-align: left">4</td><td style="text-align: left">$ docker start test_sshd2</td><td style="text-align: left">Start the second container.</td></tr><tr><td style="text-align: left">5</td><td style="text-align: left">Take a note of the ip-address of test_sshd2</td><td style="text-align: left"></td></tr><tr><td style="text-align: left">6</td><td style="text-align: left">$ ssh rob@172.17.0.2</td><td style="text-align: left">Use the ip-address step 2.</td></tr><tr><td style="text-align: left">7</td><td style="text-align: left">$ julia</td><td style="text-align: left">Start Julia, and continue at step 8 of <a href="#Test-the-code-1">Activity 2: Test the code</a></td></tr></table><h2 id="Example-test-code-1"><a class="docs-heading-anchor" href="#Example-test-code-1">Example test code</a><a class="docs-heading-anchor-permalink" href="#Example-test-code-1" title="Permalink"></a></h2><table><tr><th style="text-align: left">Step</th><th style="text-align: left">Action</th><th style="text-align: left">Comment</th></tr><tr><td style="text-align: left">1</td><td style="text-align: left">Create a file app_functions.jl</td><td style="text-align: left">In test_sshd.</td></tr><tr><td style="text-align: left">2</td><td style="text-align: left">Put the code from <a href="https://github.com/rbontekoe/AppliMaster.jl">AppliMaster.jl</a> in the file</td><td style="text-align: left"></td></tr><tr><td style="text-align: left">3</td><td style="text-align: left">Start julia</td><td style="text-align: left"></td></tr><tr><td style="text-align: left">4</td><td style="text-align: left">Run the next (initialization) code first</td><td style="text-align: left"></td></tr></table><pre><code class="language-none">julia&gt; using Distributed

julia&gt; p = addprocs([(&quot;rob@172.17.0.3&quot;, 1)]; exeflags=`--project=$(Base.active_project())`)
1-element Array{Int64,1}:
 2

julia&gt; p = p[1] #container used for invoicing

julia&gt; q = p[1] # container used for general ledger

julia&gt; @everywhere using AppliSales

julia&gt; @everywhere using AppliInvoicing

julia&gt; @everywhere using AppliGeneralLedger

julia&gt; include(&quot;./app_functions.jl&quot;);

julia&gt; rx = dispatcher()
[ Info: task_0 is waiting for data
[ Info: task_1 is waiting for data
[ Info: task_2 is waiting for data
[ Info: task_3 is waiting for data
Channel{Any}(sz_max:32,sz_curr:0)</code></pre><table><tr><th style="text-align: left">Step</th><th style="text-align: left">Action</th><th style="text-align: left">Comment</th></tr><tr><td style="text-align: left">5</td><td style="text-align: left">Run the next codel</td><td style="text-align: left"></td></tr></table><pre><code class="language-none">julia&gt; put!(rx, &quot;START&quot;); # start the application


julia&gt; stms = AppliInvoicing.read_bank_statements(PATH_CSV); # retrieve data

julia&gt; put!(rx, stms); # processing the uppaid invoices</code></pre><p>When run the code again, you will experience that it is very fast. Best is to delete first the data stores:</p><table><tr><th style="text-align: left">Step</th><th style="text-align: left">Action</th><th style="text-align: left">Comment</th></tr><tr><td style="text-align: left">6</td><td style="text-align: left">;ssh rob@172.17.0.3</td><td style="text-align: left">Go to test_ssh2.</td></tr><tr><td style="text-align: left">7</td><td style="text-align: left">;rm invoicing.sqlite journal.txt ledger.txt</td><td style="text-align: left">Delete the stores.</td></tr><tr><td style="text-align: left">8</td><td style="text-align: left">Ctrl-D</td><td style="text-align: left">Leave the container.</td></tr><tr><td style="text-align: left">9</td><td style="text-align: left">Run the previous code again</td><td style="text-align: left"></td></tr></table><h6 id="The-result-(statementrs-removed)-1"><a class="docs-heading-anchor" href="#The-result-(statementrs-removed)-1">The result (statementrs removed)</a><a class="docs-heading-anchor-permalink" href="#The-result-(statementrs-removed)-1" title="Permalink"></a></h6><pre><code class="language-none">[ Info: Dispatcher received String
[ Info: task_0 received String
[ Info: task_0 will start the process remotely

[ Info: task_0 will put 3 the orders on rx channel
[ Info: task_0 is waiting for data

[ Info: Dispatcher received Array{AppliSales.Order,1}
[ Info: Task 1 will put 3 orders on rx channel
[ Info: task_1 is waiting for data

[ Info: Dispatcher received Array{AppliGeneralLedger.JournalEntry,1}
[ Info: task_2: Processing journal entries
[ Info: task_2 is waiting for data

[ Info: Dispatcher received Array{AppliInvoicing.BankStatement,1}
[ Info: Task_3: Processing unpaid invoices
[ Info: Retrieved 3 unpaid invoices
[ Info: task_3 is waiting for data

[ Info: Dispatcher received Array{AppliGeneralLedger.JournalEntry,1}
[ Info: task_2: Processing journal entries
[ Info: task_2 is waiting for data</code></pre><h6 id="Unkown-data-will-not-be-routed!-1"><a class="docs-heading-anchor" href="#Unkown-data-will-not-be-routed!-1">Unkown data will not be routed!</a><a class="docs-heading-anchor-permalink" href="#Unkown-data-will-not-be-routed!-1" title="Permalink"></a></h6><table><tr><th style="text-align: left">Step</th><th style="text-align: left">Action</th><th style="text-align: left">Comment</th></tr><tr><td style="text-align: left">10</td><td style="text-align: left">Run the code in step 5 again</td><td style="text-align: left"></td></tr></table><pre><code class="language-none">test = &quot;Test unkown type&quot;;

put!(rx, test); # unkown type error</code></pre><h6 id="Result-1"><a class="docs-heading-anchor" href="#Result-1">Result</a><a class="docs-heading-anchor-permalink" href="#Result-1" title="Permalink"></a></h6><pre><code class="language-none">[ Info: Dispatcher received String

┌ Warning: No task found for type String
└ @ Main ~</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../chapter14/">« 14 - Run the Application in Containers</a><a class="docs-footer-nextpage" href="../chapter16/">16 - Logging »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Monday 7 September 2020 16:54">Monday 7 September 2020</span>. Using Julia version 1.5.0-rc2.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
