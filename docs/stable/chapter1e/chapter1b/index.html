<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>3 - Create and test Domain.jl ¬∑ BAWJ</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="BAWJ logo"/></a><div class="docs-package-name"><span class="docs-autofit">BAWJ</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Business Applications with Julia</a></li><li><a class="tocitem" href="../blog/">Blog</a></li><li><a class="tocitem" href="../chapter1/">1 - The Application</a></li><li><span class="tocitem">Section 1 - Experimenting with modules</span><ul><li><a class="tocitem" href="../chapter1a/">2 - Setup the Development Environment</a></li><li class="is-active"><a class="tocitem" href>3 - Create and test Domain.jl</a><ul class="internal"><li><a class="tocitem" href="#Domain.jl-Domain-objects-1"><span>Domain.jl - Domain objects</span></a></li><li><a class="tocitem" href="#Activity-3.1-Create-the-file-Domain.jl-in-the-src-folder-1"><span>Activity 3.1 - Create the file Domain.jl in the src-folder</span></a></li><li><a class="tocitem" href="#Activity-3.2-Pasting-the-domain-code-into-Domain.jl-1"><span>Activity 3.2 - Pasting the domain code into Domain.jl</span></a></li><li><a class="tocitem" href="#Dependencies-1"><span>Dependencies</span></a></li><li><a class="tocitem" href="#Activity-3.3-Adding-Dates-as-dependency-1"><span>Activity 3.3 - Adding Dates as dependency</span></a></li><li><a class="tocitem" href="#test_domain.jl-1"><span>test_domain.jl</span></a></li><li><a class="tocitem" href="#Activity-3.4-Testing-your-code-1"><span>Activity 3.4 - Testing your code</span></a></li><li><a class="tocitem" href="#runtests.jl-1"><span>runtests.jl</span></a></li><li><a class="tocitem" href="#Activity-3.5-runtests.jl-1"><span>Activity 3.5 - runtests.jl</span></a></li></ul></li><li><a class="tocitem" href="../chapter1c/">4 - Create and test API.jl</a></li><li><a class="tocitem" href="../chapter1d/">5 - Create and test Infrastructure.jl</a></li><li><a class="tocitem" href="../chapter1e/">6 - Accounts package from a user point of view</a></li></ul></li><li><span class="tocitem">Section 2 -  Accounts Receivable module</span><ul><li><a class="tocitem" href="../chapter2/">7 - The design</a></li><li><a class="tocitem" href="../chapter3/">8 - The Domain sub-module</a></li></ul></li><li><a class="tocitem" href="../appendix/">Installation Instruction</a></li><li><a class="tocitem" href="../notebook/">IJulia Notebook</a></li><li><a class="tocitem" href="../overview/">Overview Julia</a></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Section 1 - Experimenting with modules</a></li><li class="is-active"><a href>3 - Create and test Domain.jl</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>3 - Create and test Domain.jl</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/rbontekoe/BAWJ/blob/master/docs/src/chapter1b.md" title="Edit on GitHub"><span class="docs-icon fab">ÔÇõ</span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id=".-Create-and-test-Domain.jl-1"><a class="docs-heading-anchor" href="#.-Create-and-test-Domain.jl-1">3. Create and test Domain.jl</a><a class="docs-heading-anchor-permalink" href="#.-Create-and-test-Domain.jl-1" title="Permalink"></a></h1><p>UNDER DEVELOPMENT!</p><h3 id="What-you-will-learn-1"><a class="docs-heading-anchor" href="#What-you-will-learn-1">What you will learn</a><a class="docs-heading-anchor-permalink" href="#What-you-will-learn-1" title="Permalink"></a></h3><ul><li><a href="#.-Create-and-test-Domain.jl-1">3. Create and test Domain.jl</a></li><ul><li><a href="#Domain.jl-Domain-objects-1">Domain.jl - Domain objects</a></li><li><a href="#Activity-3.1-Create-the-file-Domain.jl-in-the-src-folder-1">Activity 3.1 - Create the file Domain.jl in the src-folder</a></li><li><a href="#Activity-3.2-Pasting-the-domain-code-into-Domain.jl-1">Activity 3.2 - Pasting the domain code into Domain.jl</a></li><li><a href="#Dependencies-1">Dependencies</a></li><li><a href="#Activity-3.3-Adding-Dates-as-dependency-1">Activity 3.3 - Adding Dates as dependency</a></li><li><a href="#test_domain.jl-1">test_domain.jl</a></li><li><a href="#Activity-3.4-Testing-your-code-1">Activity 3.4 - Testing your code</a></li><li><a href="#runtests.jl-1">runtests.jl</a></li><li><a href="#Activity-3.5-runtests.jl-1">Activity 3.5 - runtests.jl</a></li></ul></ul><p>To get experience with Julia and modules, we will build first an application where we can register and retrieve persons. In this module we define the Domain objects and write test code.</p><p>The activities are:</p><ul><li>Activity 3.1 - Create the file Domain.jl in the src-folder</li><li>Activity 3.2 - Add the code for sub-module Domain.jl.</li><li>Activity 3.3 - Adding Dates as dependency.</li><li>Activity 3.4 - Writing test code and a unit test.</li></ul><h2 id="Domain.jl-Domain-objects-1"><a class="docs-heading-anchor" href="#Domain.jl-Domain-objects-1">Domain.jl - Domain objects</a><a class="docs-heading-anchor-permalink" href="#Domain.jl-Domain-objects-1" title="Permalink"></a></h2><p>On the Domain page, you define the custom data structures that make-up your domain.</p><p>To define a data structure and type, use the keyword <code>struct</code>. The body consists of the fields of the data structure. A struct is a non-mutable object unless you use the preceding keyword <code>mutable.</code></p><p>Use constructors to define standard values. It simplifies the creating op the object.</p><pre><code class="language-julia">module Domain #1

using Dates #2

export Person, Address, AddressType, EMAIL, WORK #3

# local function to generate an unique id
create_key(name::String) = string(hash(name * string(time()))) #4

# enumerated type for an address.
@enum AddressType EMAIL WORK #5

struct Address #6
  id::String
  created::DateTime
  address_type::AddressType
  address::String
  #constructors
  Address(address_type, address) = new(create_key(address), now(), address_type, address)
end # Address

struct Person #7
  id::String
  created::DateTime
  name::String
  addresses::Array{Address, 1}
  #constructors
  Person(name) = new(create_key(name), name, [])
  Person(name, addresses) = new(create_key(name), now(), name, addresses)
end

end
</code></pre><p>#1 Module names start with a capital letter.</p><p>#2 If you need date functions like time(), date(), or now() you have the load the Dates package.</p><p>#3 Define what others default see when they want to use the sub-module Domain.</p><p>#4 We use the hash-function to generate an unique id. You use <code>*</code> to concatenate Strings in Julia.</p><p>#5 The AddressTypes that you allow in an Address object.</p><p>#6 The structure of the Address datatype. The constructor <code>create</code> allows the programmer to only specify the AddressType and the address. The fields <code>id</code> and <code>created</code> are generated by Julia code.</p><p>#7 The Person datatype. The fields <code>id</code> and <code>created</code> are generated by Julia code. When you don&#39;t specify an address, the software creates an empty array. Later on, you can add addresses using the <code>push!</code> function.</p><h2 id="Activity-3.1-Create-the-file-Domain.jl-in-the-src-folder-1"><a class="docs-heading-anchor" href="#Activity-3.1-Create-the-file-Domain.jl-in-the-src-folder-1">Activity 3.1 - Create the file Domain.jl in the src-folder</a><a class="docs-heading-anchor-permalink" href="#Activity-3.1-Create-the-file-Domain.jl-in-the-src-folder-1" title="Permalink"></a></h2><p>Prerequisites (activities in chapter 2)</p><ul><li>Activity 2.1 - Setup the Development Environment.</li><li>Activity 2.2 - Create the Accounts module.</li><li>Activity 2.3 - Create a Repository on GitHub.</li></ul><table><tr><th style="text-align: left">Step</th><th style="text-align: left">Action</th><th style="text-align: left">Comment</th></tr><tr><td style="text-align: left">1</td><td style="text-align: left">Go to the <code>~/.julia/dev/Accounts</code> folder</td><td style="text-align: left"></td></tr><tr><td style="text-align: left">3</td><td style="text-align: left">Remove all Taps in the right pane.</td><td style="text-align: left"></td></tr><tr><td style="text-align: left">4</td><td style="text-align: left">Right click on: src</td><td style="text-align: left"></td></tr><tr><td style="text-align: left">5</td><td style="text-align: left">Select: <code>New file</code></td><td style="text-align: left"></td></tr><tr><td style="text-align: left">6</td><td style="text-align: left">Type: <code>Domain.jl</code></td><td style="text-align: left">A file that represents a module starts with a capital letter.</td></tr><tr><td style="text-align: left">7</td><td style="text-align: left">Press: &lt;Enter&gt;</td><td style="text-align: left">A new document appears in the pane next to the navigation pane.</td></tr></table><p>In the navigation pane you see the next folders and files:</p><pre><code class="language-none">·µ•üìÅ AppliInvoicing
  ·µ•üìÅ src
     üìÑ Accounts.jl
     üìÑ Domain.jl</code></pre><h2 id="Activity-3.2-Pasting-the-domain-code-into-Domain.jl-1"><a class="docs-heading-anchor" href="#Activity-3.2-Pasting-the-domain-code-into-Domain.jl-1">Activity 3.2 - Pasting the domain code into Domain.jl</a><a class="docs-heading-anchor-permalink" href="#Activity-3.2-Pasting-the-domain-code-into-Domain.jl-1" title="Permalink"></a></h2><ul><li>The previous activity 3.1</li></ul><table><tr><th style="text-align: left">Step</th><th style="text-align: left">Action</th><th style="text-align: left">Comment</th></tr><tr><td style="text-align: left">1</td><td style="text-align: left">Select the code from the section <a href="#Domain.jl-Domain-objects-1">Domain.jl-Domain-objects</a></td><td style="text-align: left"></td></tr><tr><td style="text-align: left">2</td><td style="text-align: left">Copy the code to the clipboard</td><td style="text-align: left"></td></tr><tr><td style="text-align: left">3</td><td style="text-align: left">Paste the code in the file Domain.jl</td><td style="text-align: left"></td></tr><tr><td style="text-align: left">4</td><td style="text-align: left">Ctrl-S</td><td style="text-align: left">Save the file.</td></tr></table><h2 id="Dependencies-1"><a class="docs-heading-anchor" href="#Dependencies-1">Dependencies</a><a class="docs-heading-anchor-permalink" href="#Dependencies-1" title="Permalink"></a></h2><p>All dependencies of your module should be declared in the file <code>Build.toml</code> under the section <code>[deps]</code>. We use the now()-function in the code and is defined in Dates. Dates is a sub-module of Julia and should be loaded in your code by <code>using Dates</code>.</p><p>When someone adds our module Accounts it automatically loads the right dependency versions.</p><pre><code class="language-none">name = &quot;Accounts&quot;
uuid = &quot;a1b4bf14-7ec5-4e42-8992-fb1d0e08b0e4&quot;
authors = [&quot;Rob Bontekoe &lt;rbontekoe@appligate.nl&gt; and contributors&quot;]
version = &quot;0.1.0&quot;

[deps]
Dates = &quot;ade2ca70-3891-5945-98fb-dc099432e06a&quot;

[compat]
julia = &quot;1&quot;

[extras]
Test = &quot;8dfed614-e22c-5e08-85e1-65c5234f0b40&quot;

[targets]
test = [&quot;Test&quot;]</code></pre><p><em>Fig 3.1</em></p><h2 id="Activity-3.3-Adding-Dates-as-dependency-1"><a class="docs-heading-anchor" href="#Activity-3.3-Adding-Dates-as-dependency-1">Activity 3.3 - Adding Dates as dependency</a><a class="docs-heading-anchor-permalink" href="#Activity-3.3-Adding-Dates-as-dependency-1" title="Permalink"></a></h2><h4 id="Prerequisites-1"><a class="docs-heading-anchor" href="#Prerequisites-1">Prerequisites</a><a class="docs-heading-anchor-permalink" href="#Prerequisites-1" title="Permalink"></a></h4><ul><li>The previous activity 3.2</li></ul><p>You automatically add dependencies to the file <code>Build.toml</code> when you switch to your Accounts environment.</p><table><tr><th style="text-align: left">Step</th><th style="text-align: left">Action</th><th style="text-align: left">Comment</th></tr><tr><td style="text-align: left">1</td><td style="text-align: left">jullia&gt; ]</td><td style="text-align: left">Activate the package manager.</td></tr><tr><td style="text-align: left">2</td><td style="text-align: left">pkg&gt; activate .</td><td style="text-align: left">Go to the Accounts environment.</td></tr><tr><td style="text-align: left">3</td><td style="text-align: left">(Accounts) pkg&gt; status</td><td style="text-align: left">Show Accounts loaded packages (dependencies)</td></tr><tr><td style="text-align: left">4</td><td style="text-align: left">(Accounts) pkg&gt; add Dates</td><td style="text-align: left">Add the Dates module.</td></tr><tr><td style="text-align: left">5</td><td style="text-align: left">(Accounts) pkg&gt; status</td><td style="text-align: left">Shows your dependencies.</td></tr></table><pre><code class="language-none">Project Accounts v0.1.0
Status `~/.julia/dev/Accounts/Project.toml`
  [ade2ca70] Dates</code></pre><table><tr><th style="text-align: left">Step</th><th style="text-align: left">Action</th><th style="text-align: left">Comment</th></tr><tr><td style="text-align: left">6</td><td style="text-align: left">Press: BackSpace</td><td style="text-align: left">return to the Julia prompt.</td></tr></table><h2 id="test_domain.jl-1"><a class="docs-heading-anchor" href="#test_domain.jl-1">test_domain.jl</a><a class="docs-heading-anchor-permalink" href="#test_domain.jl-1" title="Permalink"></a></h2><pre><code class="language-none">using Pkg; Pkg.activate(&quot;.&quot;)

import Accounts: Domain

using .Domain

rob_address_email = Address(EMAIL, &quot;rbontekoe@appligate.nl&quot;)
rob_address_work = Address(WORK,
  &quot;&quot;&quot;
  Landweg 74
  3833VM LEUSDEN
  The Netherlands
  &quot;&quot;&quot;
)

addresses = [rob_address_email, rob_address_work]

rob = Person(&quot;Rob Bontekoe&quot;, addresses)

email_address = filter(x -&gt; x.address_type == EMAIL, rob.addresses)

println(email_address[1].address)</code></pre><h2 id="Activity-3.4-Testing-your-code-1"><a class="docs-heading-anchor" href="#Activity-3.4-Testing-your-code-1">Activity 3.4 - Testing your code</a><a class="docs-heading-anchor-permalink" href="#Activity-3.4-Testing-your-code-1" title="Permalink"></a></h2><p>Most of the time you put code want to test parts of your application in a test file.</p><h4 id="Prerequisites-2"><a class="docs-heading-anchor" href="#Prerequisites-2">Prerequisites</a><a class="docs-heading-anchor-permalink" href="#Prerequisites-2" title="Permalink"></a></h4><ul><li>The previous activity 3.3</li></ul><table><tr><th style="text-align: left">Step</th><th style="text-align: left">Action</th><th style="text-align: left">Comment</th></tr><tr><td style="text-align: left">1</td><td style="text-align: left">Create the file test_domain.jl</td><td style="text-align: left"></td></tr><tr><td style="text-align: left">2</td><td style="text-align: left">Copy the test_domain.jl code into the file</td><td style="text-align: left">See: <a href="#test_domain.jl-1">test_domain.jl</a></td></tr><tr><td style="text-align: left">3</td><td style="text-align: left">Ctrl-S</td><td style="text-align: left">Save the file.</td></tr><tr><td style="text-align: left">4</td><td style="text-align: left">Select the first line</td><td style="text-align: left"></td></tr><tr><td style="text-align: left">5</td><td style="text-align: left">Shift-Enter</td><td style="text-align: left">The line will execute.</td></tr><tr><td style="text-align: left">6</td><td style="text-align: left">Repeat until the last line.</td><td style="text-align: left"></td></tr><tr><td style="text-align: left">7</td><td style="text-align: left">Ctrl-Enter</td><td style="text-align: left">The cursor stays on the current line.</td></tr></table><h2 id="runtests.jl-1"><a class="docs-heading-anchor" href="#runtests.jl-1">runtests.jl</a><a class="docs-heading-anchor-permalink" href="#runtests.jl-1" title="Permalink"></a></h2><p>It is even better to put you test code in the file runtest.jl. The file is located in the folder test.</p><pre><code class="language-none">using Accounts
using Test

import Accounts: Domain
using .Domain

@testset &quot;Domain.jl&quot; begin
    rob_address_email = Address(EMAIL, &quot;rbontekoe@appligate.nl&quot;)
    rob = Person(&quot;Rob Bontekoe&quot;, [rob_address_email])
    email_addresses = filter(x -&gt; x.address_type == EMAIL, rob.addresses)
    @test email_addresses[1].address == &quot;rbontekoe@appligate.nl&quot;
end</code></pre><h2 id="Activity-3.5-runtests.jl-1"><a class="docs-heading-anchor" href="#Activity-3.5-runtests.jl-1">Activity 3.5 - runtests.jl</a><a class="docs-heading-anchor-permalink" href="#Activity-3.5-runtests.jl-1" title="Permalink"></a></h2><h4 id="Prerequisites-3"><a class="docs-heading-anchor" href="#Prerequisites-3">Prerequisites</a><a class="docs-heading-anchor-permalink" href="#Prerequisites-3" title="Permalink"></a></h4><ul><li>The previous activity 3.3</li></ul><table><tr><th style="text-align: left">Step</th><th style="text-align: left">Action</th><th style="text-align: left">Comment</th></tr><tr><td style="text-align: left">1</td><td style="text-align: left">julia&gt; ]</td><td style="text-align: left">Activate package manager.</td></tr><tr><td style="text-align: left">2</td><td style="text-align: left">pkg&gt; activate .</td><td style="text-align: left">Activate Accounts environment.</td></tr><tr><td style="text-align: left">3</td><td style="text-align: left">(Accounts) Pkg&gt; st</td><td style="text-align: left">Check whether Dates is loaded. See activity 3.3.</td></tr><tr><td style="text-align: left">4</td><td style="text-align: left">(Accounts) Pkg&gt;  test Accounts</td><td style="text-align: left">Run the test code. The result is:</td></tr></table><pre><code class="language-none">Test Summary: | Pass  Total
Domain.jl     |    1      1
    Testing Accounts tests passed</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../chapter1a/">¬´ 2 - Setup the Development Environment</a><a class="docs-footer-nextpage" href="../chapter1c/">4 - Create and test API.jl ¬ª</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Friday 7 August 2020 17:11">Friday 7 August 2020</span>. Using Julia version 1.5.0-rc2.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
